<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringCloud Eureka | 乔木先生</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Java后端技术博客,专注Java后端学习与总结。Java,Spring,SpringBoot,SpringMVC,SpringCloud,Mybatis,Linux,css3,html5,Maven,git,github等技术文章。">
    <meta name="keywords" content="Java后端技术博客,专注Java后端学习与总结。Java,Spring,SpringBoot,SpringMVC,SpringCloud,Mybatis,Linux,css3,html5,Maven,git,github等技术文章。">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.a29a3543.css" as="style"><link rel="preload" href="/assets/js/app.ce0d757e.js" as="script"><link rel="preload" href="/assets/js/2.06b51e28.js" as="script"><link rel="preload" href="/assets/js/6.de48cd74.js" as="script"><link rel="prefetch" href="/assets/js/10.25ab3c87.js"><link rel="prefetch" href="/assets/js/11.0710d907.js"><link rel="prefetch" href="/assets/js/12.b69f61e1.js"><link rel="prefetch" href="/assets/js/13.7c680a8f.js"><link rel="prefetch" href="/assets/js/14.c2a530ec.js"><link rel="prefetch" href="/assets/js/15.0344ac89.js"><link rel="prefetch" href="/assets/js/16.8ba3e333.js"><link rel="prefetch" href="/assets/js/17.d5aa2799.js"><link rel="prefetch" href="/assets/js/18.220bdb83.js"><link rel="prefetch" href="/assets/js/19.67fc625a.js"><link rel="prefetch" href="/assets/js/20.8a296438.js"><link rel="prefetch" href="/assets/js/21.bebe2d14.js"><link rel="prefetch" href="/assets/js/22.a2f38cf1.js"><link rel="prefetch" href="/assets/js/23.584f4a98.js"><link rel="prefetch" href="/assets/js/24.b4f54e0d.js"><link rel="prefetch" href="/assets/js/25.4e296918.js"><link rel="prefetch" href="/assets/js/26.e9f8a341.js"><link rel="prefetch" href="/assets/js/27.d1e12903.js"><link rel="prefetch" href="/assets/js/28.aad73944.js"><link rel="prefetch" href="/assets/js/29.1f69ecb2.js"><link rel="prefetch" href="/assets/js/3.04a7b8c9.js"><link rel="prefetch" href="/assets/js/30.31228ad4.js"><link rel="prefetch" href="/assets/js/31.876161e0.js"><link rel="prefetch" href="/assets/js/32.00970883.js"><link rel="prefetch" href="/assets/js/33.d6286171.js"><link rel="prefetch" href="/assets/js/34.6f7f8dea.js"><link rel="prefetch" href="/assets/js/35.61b61fb3.js"><link rel="prefetch" href="/assets/js/36.ff818b3d.js"><link rel="prefetch" href="/assets/js/37.3b4a7cce.js"><link rel="prefetch" href="/assets/js/38.c3e4cbf3.js"><link rel="prefetch" href="/assets/js/4.23b49261.js"><link rel="prefetch" href="/assets/js/5.cf7ce6d9.js"><link rel="prefetch" href="/assets/js/7.5fd9e1bc.js"><link rel="prefetch" href="/assets/js/8.31885ab6.js"><link rel="prefetch" href="/assets/js/9.88734d8e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a29a3543.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="乔木先生" class="logo"> <span class="site-name can-hide">乔木先生</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/kas755c4/" class="nav-link">JavaSE</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java框架" class="dropdown-title"><!----> <span class="title" style="display:;">Java框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/24j4ehty/" aria-current="page" class="nav-link router-link-exact-active router-link-active">SpringCloud</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>NoSQL</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bp3ikv4g/" class="nav-link">Redis</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><!----> <span class="title" style="display:;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>消息中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/vd45cpcf/" class="nav-link">RabbitMQ</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><!----> <span class="title" style="display:;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/e938xib2/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/eb9ks77i/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qaomuu" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/kas755c4/" class="nav-link">JavaSE</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java框架" class="dropdown-title"><!----> <span class="title" style="display:;">Java框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/24j4ehty/" aria-current="page" class="nav-link router-link-exact-active router-link-active">SpringCloud</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>NoSQL</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/bp3ikv4g/" class="nav-link">Redis</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><!----> <span class="title" style="display:;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>消息中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/vd45cpcf/" class="nav-link">RabbitMQ</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><!----> <span class="title" style="display:;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/e938xib2/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/eb9ks77i/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/qaomuu" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>SpringCloud</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/24j4ehty/" aria-current="page" class="active sidebar-link">SpringCloud Eureka</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#简介" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#服务治理" class="sidebar-link">服务治理</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eureka概述" class="sidebar-link">Eureka概述</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#基本原理" class="sidebar-link">基本原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#服务注册与发现" class="sidebar-link">服务注册与发现</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eureka-server提供服务注册服务" class="sidebar-link">Eureka Server提供服务注册服务</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekaclient通过注册中心进行访问" class="sidebar-link">EurekaClient通过注册中心进行访问</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#eureka单机" class="sidebar-link">Eureka单机</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekaserver搭建" class="sidebar-link">EurekaServer搭建</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekacilent搭建" class="sidebar-link">EurekaCilent搭建</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#eureka集群" class="sidebar-link">Eureka集群</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekaserver集群" class="sidebar-link">EurekaServer集群</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekacilent注册进server集群" class="sidebar-link">EurekaCilent注册进Server集群</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#eurekacilent集群" class="sidebar-link">EurekaCilent集群</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#负载均衡" class="sidebar-link">负载均衡</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#信息完善" class="sidebar-link">信息完善</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#修改服务名" class="sidebar-link">修改服务名</a></li><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#ip信息显示" class="sidebar-link">IP信息显示</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#服务发现discovery" class="sidebar-link">服务发现Discovery</a></li><li class="sidebar-sub-header level2"><a href="/pages/24j4ehty/#自我保护" class="sidebar-link">自我保护</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/24j4ehty/#禁止自我保护" class="sidebar-link">禁止自我保护</a></li><li class="sidebar-sub-header level4"><a href="/pages/24j4ehty/#服务端配置" class="sidebar-link">服务端配置</a></li><li class="sidebar-sub-header level4"><a href="/pages/24j4ehty/#客户端配置" class="sidebar-link">客户端配置</a></li></ul></li></ul></li><li><a href="/pages/09kei4a8/" class="sidebar-link">SpringCloud Zookeeper</a></li><li><a href="/pages/yuu0dk4i/" class="sidebar-link">SpringCloud Consul</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Java%E6%A1%86%E6%9E%B6" title="分类" data-v-06225672>Java框架</a></li><li data-v-06225672><a href="/categories/?category=SpringCloud" title="分类" data-v-06225672>SpringCloud</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>乔木先生</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-12-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">SpringCloud Eureka<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <h3 id="服务治理"><a href="#服务治理" class="header-anchor">#</a> 服务治理</h3> <p>Spring Cloud 封装了 Netflix 公司开发的 Eureka 模块来实现服务治理，在传统的rpc远程调用框架中，管理每个服务与服务之间依赖关系比较复杂，管理比较复杂，所以需要使用服务治理，管理服务于服务之间依赖关系，可以实现服务调用、负载均衡、容错等，实现服务发现与注册。</p> <h3 id="eureka概述"><a href="#eureka概述" class="header-anchor">#</a> Eureka概述</h3> <p>Eureka是基于REST（Representational State Transfer）服务，主要以AWS云服务为支撑，提供服务发现并实现负载均衡和故障转移。Eureka是一款由Netflix公司开发的服务注册组件，已经停止更新了。</p> <p><img src="https://file.qaomuu.com/blog/J5uv--OlKmZzYKWK8x-n5bBDM_8qOzaEu0LLnl42Yas.png" alt="image"></p> <h2 id="基本原理"><a href="#基本原理" class="header-anchor">#</a> 基本原理</h2> <p>Eureka采用C-S的设计架构，包含Eureka Server 和Eureka Client两个组件</p> <p>服务启动后向Eureka注册，Eureka Server会将注册信息向其他Eureka Server进行同步，当服务消费者要调用服务提供者，则向服务注册中心获取服务提供者地址，然后会将服务提供者地址缓存在本地，下次再调用时，则直接从本地缓存中取，完成一次调用。</p> <h3 id="服务注册与发现"><a href="#服务注册与发现" class="header-anchor">#</a> 服务注册与发现</h3> <p>Eureka Server 作为服务注册功能的服务器，它是服务注册中心。而系统中的其他微服务，使用 Eureka的客户端连接到Eureka Server 并维持心跳连接。这样系统的维护人员就可以通过 Eureka Server 来监控系统中各个微服务是否正常运行。</p> <p>在服务注册与发现中，有一个注册中心。当服务器启动的时候，会把当前自己服务器的信息(比如服务地址通讯地址等)以别名方式注册到注册中心上。另一方(消费者|服务提供者)，以该别名的方式去注册中心上获取到实际的服务通讯地址，然后再实现本地RPC调用RPC远程调用框架。</p> <blockquote><p>核心设计思想：在于注册中心，因为使用注册中心管理每个服务与服务之间的一个依赖关系(服务治理概念)。在任何rpc远程框架中，都会有一个注册中心(存放服务地址相关信息(接口地址))</p></blockquote> <p><img src="https://file.qaomuu.com/blog/rc5W1g9HPYiu3Mt06RnbWPAOYfxLPXCuF0lW2z0Y7LY.png" alt="image"></p> <blockquote><p><strong>Eureka包含两个组件：Eureka Server和Eureka Client</strong></p></blockquote> <h3 id="eureka-server提供服务注册服务"><a href="#eureka-server提供服务注册服务" class="header-anchor">#</a> Eureka Server提供服务注册服务</h3> <p>各个微服务节点通过配置启动后，会在EurekaServer中进行注册，这样EurekaServer中的服务注册表中将会存储所有可用服务节点的信息，服务节点的信息可以在界面中直观看到。</p> <h3 id="eurekaclient通过注册中心进行访问"><a href="#eurekaclient通过注册中心进行访问" class="header-anchor">#</a> EurekaClient通过注册中心进行访问</h3> <p>是一个Java客户端，用于简化Eureka Server的交互，客户端同时也具备一个内置的、使用轮询(round-robin)负载算法的负载均衡器。在应用启动后，将会向Eureka Server发送心跳(默认周期为30秒)。如果Eureka Server在多个心跳周期内没有接收到某个节点的心跳，EurekaServer将会从服务注册表中把这个服务节点移除（默认90秒）。</p> <p>但是会存在当网络分区发生故障，导致该时间内没有心跳连接，但该服务本身还是健康运行的情况。Eureka通过“自我保护模式”来解决这个问题。在自我保护模式中，Eureka Server会保护服务注册表中的信息，不再注销任何服务实例。</p> <h2 id="eureka单机"><a href="#eureka单机" class="header-anchor">#</a> Eureka单机</h2> <h3 id="eurekaserver搭建"><a href="#eurekaserver搭建" class="header-anchor">#</a> EurekaServer搭建</h3> <p>创建一个maven模块，添加依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- eureka-server --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- cloud2018以前的版本 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-eureka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>配置application.yml文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7001</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> localhost <span class="token comment">#eureka服务端的实例名称</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#false表示不向注册中心注册自己。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment">#false表示自己端就是注册中心，维护服务实例，并不需要去检索服务</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment">#设置与Eureka Server交互的地址查询服务和注册服务都需要依赖这个地址。</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>eureka.instance.hostname<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>/eureka/
                          <span class="token comment">#     指向 localhost           指向  7001</span>
</code></pre></div><p>编写主方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaServer</span> <span class="token comment">// 表示这个项目是服务注册中心</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EurekaMain</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">EurekaMain</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>启动该项目，显示该页面表示服务注册中心启动成功</p> <p><img src="https://file.qaomuu.com/blog/WRkqR3f40NUoqkxr1m_C8_NpWoDPsQFLD0ND3QaG2PA.png" alt="image"></p> <h3 id="eurekacilent搭建"><a href="#eurekacilent搭建" class="header-anchor">#</a> EurekaCilent搭建</h3> <p>添加依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-netflix-eureka-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- cloud2018以前的版本 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-eureka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在启动类上加入该注解</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 表示这个项目入驻Eureka</span>
<span class="token annotation punctuation">@EnableEurekaClient</span> 
</code></pre></div><p>在application.yml文件中配置Eureka</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span>

<span class="token comment"># 服务名</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token comment"># 这里的名字就是注册进Eureka的服务名</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service 

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment"># 表示是否将自己注册进EurekaServer默认为true。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment"># 是否从EurekaServer抓取已有的注册信息，默认为true。</span>
    <span class="token comment"># 单节点无所谓，集群必须设置为true才能配合ribbon使用负载均衡</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>7001/eureka
                <span class="token comment">#   指向服务注册中心的url</span>
</code></pre></div><p>启动项目，需要先启动eureka的服务端，进入服务端的服务注册中心页面，看到Client端的服务名表示注册成功</p> <p><img src="https://file.qaomuu.com/blog/5QfoVk8vber2o1A-uq6LUbB9hi3R_BUnBf0PV5EiLSo.png" alt="image"></p> <h2 id="eureka集群"><a href="#eureka集群" class="header-anchor">#</a> Eureka集群</h2> <p>Eureka是SpringCloud应用中的注册中心，用来提供服务注册与发现功能。在实际生产活动中，如果单机部署的Eureka服务发生宕机，虽然已注册到Eureka的微服务可以被其客户端记录并保留，但无法再提供故障节点的剔除与新服务节点的发现功能。</p> <p>Eureka集群则可以创建多个Eureka应用，互相之间同步客户端注册信息，又可以独立提供服务发现与注册服务。</p> <p>其实Eureka本身就是为集群部署而设计的，所以部署Eureka集群需要修改的配置项并不多。</p> <p><img src="https://file.qaomuu.com/blog/MlrHRBPGgu3adbLSuGrXj2-MvLMLIgMJsDmFmi_312I.png" alt="image"></p> <h3 id="eurekaserver集群"><a href="#eurekaserver集群" class="header-anchor">#</a> EurekaServer集群</h3> <blockquote><p>互相注册，相互守望</p></blockquote> <p>在学习阶段集群是部署在同一台电脑上的，eureka服务端的实例名称会是一样的，需要修改一下系统的映射配置。在<code>C:\Windows\System32\drivers\etc</code>文件夹下找到hosts文件。</p> <p><img src="https://file.qaomuu.com/blog/Gl0pmxz6OMWGu6uhsUVDip_ryRnOcS0FYdUkh79tDpk.png" alt="image"></p> <p>将自己的集群信息进行配置进去</p> <p><img src="https://file.qaomuu.com/blog/XE_HUVhBWiVfr1rbOYnP86TN12TensyJDz5kZ2-_bAU.png" alt="image"></p> <p>修改原来的application.yml文件，将其变更为集群的环境</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7001</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token comment"># eureka服务端的实例名称</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka7001.com 
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment"># false表示不向注册中心注册自己。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment"># false表示自己端就是注册中心，我的职责就是维护服务实例，并不需要去检索服务</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment"># 设置与Eureka Server交互的地址查询服务和注册服务都需要依赖这个地址。</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka/
                      <span class="token comment"># 指向7002的服务中心</span>
</code></pre></div><p>新建一个模块，pom.xml和主启动类不变。application.yml配置为7002的服务中心</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">7002</span>

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token comment"># eureka服务端的实例名称</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka7002.com 
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#false表示不向注册中心注册自己。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment">#false表示自己端就是注册中心，我的职责就是维护服务实例，并不需要去检索服务</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment">#设置与Eureka Server交互的地址查询服务和注册服务都需要依赖这个地址。</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7002/eureka/
                          <span class="token comment"># 指向7001服务中心</span>
</code></pre></div><blockquote><p>到目前为止就创建了两个eureka服务端，在service-url中，7001和7002相互指向。</p></blockquote> <p>启动两个服务，访问</p> <p><img src="https://file.qaomuu.com/blog/9Cfsuemfj0a0z-x8aRvNk75RlzzLva4JCsifp_GjqKM.png" alt="image"></p> <p><img src="https://file.qaomuu.com/blog/RNvxAKbOacAT7mpURYuzr4pYHkoq4wFeAuzJiJhe0Ns.png" alt="image"></p> <p>当7001和7002服务互相指向的时候，说明集群搭建成功</p> <blockquote><p>相互注册，如果还有一台eureka服务端(7003)，则在配置yml文件的时候需要将7001指向7002和7003</p></blockquote> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment"># 集群</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka

</code></pre></div><h3 id="eurekacilent注册进server集群"><a href="#eurekacilent注册进server集群" class="header-anchor">#</a> EurekaCilent注册进Server集群</h3> <p>将服务注册中心的url配置为集群的url即可</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># defaultZone: http://localhost:7001/eureka  # 单机版</span>
<span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka  <span class="token comment"># 集群版</span>
</code></pre></div><p>下面是完整的yml文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 端口号</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span>

<span class="token comment"># 服务名</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token comment"># 这里的名字就是注册进Eureka的服务名</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service 

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#表示是否将自己注册进EurekaServer默认为true。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#是否从EurekaServer抓取已有的注册信息，默认为true。</span>
    <span class="token comment">#单节点无所谓，集群必须设置为true才能配合ribbon使用负载均衡</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
<span class="token comment">#      defaultZone: http://localhost:7001/eureka  # 单机版</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka  <span class="token comment"># 集群版</span>
                <span class="token comment">#   指向服务注册中心的url</span>
</code></pre></div><p>将四个微服务启动，<strong>要先启动Server集群，后启动Client服务</strong></p> <p><img src="https://file.qaomuu.com/blog/XJNG342xU9rUiUfSwmmWTwb4hXqlPgIKonMO-H4Zr9A.png" alt="image"></p> <p>调用接口测试，一般即启动成功</p> <p><img src="https://file.qaomuu.com/blog/9gyX1J4ycwDQcqs0L_2nw6MXOnKd7Ao-DLd-vOCCth0.png" alt="image"></p> <p>此时，服务中心有两个，服务提供者确只有一个，下面搭建服务提供者的集群</p> <h3 id="eurekacilent集群"><a href="#eurekacilent集群" class="header-anchor">#</a> EurekaCilent集群</h3> <p>创建一个端口号为8002的服务提供模块：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8002</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#表示是否将自己注册进EurekaServer默认为true。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#是否从EurekaServer抓取已有的注册信息，默认为true。单节点无所谓，集群必须设置为true才能配合ribbon使用负载均衡</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token comment">#defaultZone: http://localhost:7001/eureka</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka  <span class="token comment"># 集群版</span>
</code></pre></div><p>按顺序打开所有服务，此时已经注册了三个服务</p> <p><img src="https://file.qaomuu.com/blog/wqcxSSyKHZK6LjsBI_SnGumv0N7gAjBBQFEBH5NmVWQ.png" alt="image"></p> <h3 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h3> <blockquote><p>现在的系统逻辑是：order服务使用RestTemplate调用payment服务，但现在payment有两台机器，之前的写法是ip+端口号写死的，现在则需要负载均衡到两台机器上。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/payment/get/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8001/payment/get/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>现在服务提供者有两台机器，可以让RestTemplate去选择调用哪一个，可以将调用变更为：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">PAYMENT_URL</span> <span class="token operator">=</span> <span class="token string">&quot;http://CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/payment/get/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token constant">PAYMENT_URL</span> <span class="token operator">+</span> <span class="token string">&quot;/payment/get/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>url和服务名是相互对应的</p> <p><img src="https://file.qaomuu.com/blog/Wa6IhH2FgBBchTnx1VINCTCBD1G4I0clH8QRsRkzVSI.png" alt="image"></p> <p>因为一个服务名下有多个服务，修改好之后，重启，此时RestTemplate并不知道到底要调用哪一个，就会报错：</p> <p><img src="https://file.qaomuu.com/blog/urXxgwNzek1-GeP-7EoEw3mmzI3metSrSk5T3ztRCsI.png" alt="image"></p> <p>**给RestTemplate赋予负载均衡的能力，**在声明RestTemplate的配置类中，加入<code>@LoadBalanced</code>注解</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>   <span class="token comment">// 赋予RestTemplate负载均衡的能力</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>再次重启后就可以通过服务名称直接调用服务，多次调用该接口，会发现是交替(轮询)的切换两个服务提供者，此时Consumer可以直接调用服务而不再关心地址和端口号，并且该服务还具备了负载均衡的功能</p> <p><img src="https://file.qaomuu.com/blog/oKK9AXXcxqR-3YsUnW3ddG8Bfz8jjLSLlSad2DSnhto.png" alt="image"></p> <h2 id="信息完善"><a href="#信息完善" class="header-anchor">#</a> 信息完善</h2> <h3 id="修改服务名"><a href="#修改服务名" class="header-anchor">#</a> 修改服务名</h3> <p>在Eureka中，机器的名字默认显示的是<code>主机名:服务名:端口号</code> ，对于服务的机器辨识会比较模糊，如果是使用“1号机”、“5号机”等类似的名称可能更直观，如果有此方面的需求，可以进行修改服务名称。</p> <p><img src="https://file.qaomuu.com/blog/0ZTCCNkPMLZFqNWI1OinUbH7OAphhfyVxNH7oRbHwQw.png" alt="image"></p> <p>需要引入以下两个依赖：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>下面是修改后的yml文件：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloud<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>service

<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token comment">#表示是否将自己注册进EurekaServer默认为true。</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">#是否从EurekaServer抓取已有的注册信息，默认为true。</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
      <span class="token comment"># 设置eureka服务注册中心中的主机名称</span>
      <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> payment8001
</code></pre></div><p>修改过后的样子：</p> <p><img src="https://file.qaomuu.com/blog/5Ge3hqLH0VPZ5EMUWoJS6_VKoOUfvJ8947H139RUhzk.png" alt="image"></p> <h3 id="ip信息显示"><a href="#ip信息显示" class="header-anchor">#</a> IP信息显示</h3> <p>在yml文件中修改配置：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
      <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> payment8001
      <span class="token comment">#访问路径可以显示IP地址</span>
      <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><p><img src="https://file.qaomuu.com/blog/QWqXulffZ6V8Prnj50J_gfCdYlwDd6ww54THng6q1NA.png" alt="image"></p> <h2 id="服务发现discovery"><a href="#服务发现discovery" class="header-anchor">#</a> 服务发现Discovery</h2> <p>对于注册进eureka里面的微服务，可以通过服务发现来获得该服务的信息</p> <p>开启服务发现<code>@EnableDiscoveryClient</code>：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableEurekaClient</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>    <span class="token comment">// 开启服务发现</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain8001</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain8001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>修改Eureku中的客户端Controller：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Resource</span>
<span class="token keyword">private</span> <span class="token class-name">DiscoveryClient</span> discoveryClient<span class="token punctuation">;</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/payment/discovery&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">discovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获得服务清单列表</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> services <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> service <span class="token operator">:</span> services<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;service：{}&quot;</span><span class="token punctuation">,</span> service<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 一个微服务名称下面的所有实例</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span><span class="token string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ServiceInstance</span> instance <span class="token operator">:</span> instances<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;{}\t{}\t{}\t{}&quot;</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span><span class="token function">getInstanceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            instance<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>discoveryClient<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过服务发现类<code>DiscoveryClient</code>的<code>getServices()</code>方法，可以获取到服务的清单列表</p> <p><img src="https://file.qaomuu.com/blog/f-fWXTwXumevUqkrG86whAD7UBfScccxdLEQrYjeae8.png" alt="image"></p> <p>通过<code>getInstances(&quot;CLOUD-PAYMENT-SERVICE&quot;);</code>方法可以得到该服务名下的所有实例的信息，该方法的传参就是服务名</p> <p>两个方法的调用和输出，看到如下信息：</p> <p><img src="https://file.qaomuu.com/blog/bktDeBztzhFsI01vqYshlRGog4n9DZIKXqT5qnF72MY.png" alt="image"></p> <p>而web端打印的信息则是服务的列表，order表示的是当前服务的顺序</p> <p><img src="https://file.qaomuu.com/blog/YAUz3GR3wH9KZudN3e07PkI5PQzGxrWYp4FE2lrDOvA.png" alt="image"></p> <h2 id="自我保护"><a href="#自我保护" class="header-anchor">#</a> 自我保护</h2> <blockquote><p>某时刻某一个微服务不可用了，Eureka不会立刻清理，依旧会对该微服务的信息进行保存。属于CAP里面的AP分支。</p></blockquote> <p>保护模式主要用于一组客户端和Eureka Server之间存在网络分区场景下的保护。一旦进入保护模式，Eureka Server将会尝试保护其服务注册表中的信息，不再删除服务注册表中的数据，也就是不会注销任何微服务。</p> <p>如果在Eureka Server的首页看到以下这段提示，则说明Eureka进入了保护模式：</p> <p><img src="https://file.qaomuu.com/blog/EfZhHWmpdAIK8Kwy8pkkppNKFsD34IazV3_AFa2Zq_g.png" alt="image"></p> <p><strong>为什么会产生Eureka自我保护机制？</strong></p> <blockquote><p>为了防止EurekaClient可以正常运行，但是与EurekaServer网络不通情况下，EurekaServer不会立刻将EurekaClient服务剔除。</p></blockquote> <p><strong>什么是自我保护模式？</strong></p> <blockquote><p>默认情况下，如果EurekaServer在一定时间内没有接收到某个微服务实例的心跳，EurekaServer将会注销该实例（默认90秒）。但是当网络分区故障发生(延时、卡顿、拥挤)时，微服务与EurekaServer之间无法正常通信，以上行为可能变得非常危险了——因为微服务本身其实是健康的，此时本不应该注销这个微服务。Eureka通过“自我保护模式”来解决这个问题——当EurekaServer节点在短时间内丢失过多客户端时（可能发生了网络分区故障），那么这个节点就会进入自我保护模式。</p></blockquote> <p><img src="https://file.qaomuu.com/blog/3FxhG2y1-Yh5w5NRS83xspbKgGSB-i9znJ0pNAGCSDk.png" alt="image"></p> <p>在自我保护模式中，Eureka Server会保护服务注册表中的信息，不再注销任何服务实例。它的设计哲学就是宁可保留错误的服务注册信息，也不盲目注销任何可能健康的服务实例。</p> <p>综上，自我保护模式是一种应对网络异常的安全保护措施。它的架构哲学是宁可同时保留所有微服务（健康的微服务和不健康的微服务都会保留）也不盲目注销任何健康的微服务。使用自我保护模式，可以让Eureka集群更加的健壮、稳定。</p> <h3 id="禁止自我保护"><a href="#禁止自我保护" class="header-anchor">#</a> 禁止自我保护</h3> <h4 id="服务端配置"><a href="#服务端配置" class="header-anchor">#</a> 服务端配置</h4> <p>在application.yml文件中加入配置</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka7001.com
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka/
<span class="token comment"># ####################禁止自我保护####################</span>
  <span class="token key atrule">server</span><span class="token punctuation">:</span>
    <span class="token comment"># 关闭自我保护机制，保证不可用服务被及时清除</span>
    <span class="token key atrule">enable-self-preservation</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token comment"># 2000毫秒没有反应就清除</span>
    <span class="token key atrule">eviction-interval-timer-in-ms</span><span class="token punctuation">:</span> <span class="token number">2000</span>
</code></pre></div><p>配置好后，就能在eureka的页面看到如下信息：</p> <p><img src="https://file.qaomuu.com/blog/nzjp2jVLQSi-y282i1DyH3w30cbSwb4xgHxzBn8HC38.png" alt="image"></p> <h4 id="客户端配置"><a href="#客户端配置" class="header-anchor">#</a> 客户端配置</h4> <p>在application.yml配置文件中进行配置：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//eureka7001.com<span class="token punctuation">:</span>7001/eureka<span class="token punctuation">,</span>http<span class="token punctuation">:</span>//eureka7002.com<span class="token punctuation">:</span>7002/eureka
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">instance-id</span><span class="token punctuation">:</span> payment8001
    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment"># ####################设置心跳时间####################</span>
    <span class="token comment"># Eureka客户端向服务端发送心跳的时间间隔，单位为秒(默认是30秒)</span>
    <span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">1</span>
    <span class="token comment"># Eureka服务端在收到最后一次心跳后等待时间上限，单位为秒(默认是90秒)，超时将剔除服务</span>
    <span class="token key atrule">lease-expiration-duration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">2</span>
</code></pre></div><p>配置成功后重启发现8001服务已经被注册进了eureka</p> <p><img src="https://file.qaomuu.com/blog/Bdjz8OAZrGLz9-Qx65Mh0fMtuhK_ztRTlkfJwOIUHl4.png" alt="image"></p> <p>假设现在8001出现问题(关闭8001服务)，此时可以看到8001服务立刻被清除，不再进行自我保护机制</p> <p><img src="https://file.qaomuu.com/blog/urdvPpCygMjse6MocveiFgHNTVsGK1Yc3EHSTo1Qa8U.png" alt="image"></p></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=SpringCloud" title="标签">#SpringCloud</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/11/30, 16:24:57</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/09kei4a8/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">SpringCloud Zookeeper</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/09kei4a8/">SpringCloud Zookeeper</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/jsf92i5m/"><div>
            SpringBoot整合Redis
            <!----></div></a> <span class="date">12-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/a7v81744/"><div>
            Redis Java客户端Jedis
            <!----></div></a> <span class="date">12-20</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/lp31htbk/"><div>
            MacOS安装Git
            <!----></div></a> <span class="date">12-19</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>| <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">浙ICP备2022027766号-1</a><br><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33011002016801" target="_blank">浙公网安备 33011002016801号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ce0d757e.js" defer></script><script src="/assets/js/2.06b51e28.js" defer></script><script src="/assets/js/6.de48cd74.js" defer></script>
  </body>
</html>
